<template>
    <div class="gis-selection">
        <div class="date-selection">
            <div class="select">
                <label>单位：</label>
                <select v-model="selectedProvince" @change="onProvinceChange">
                    <option value="" disabled>
                        <span>请选择单位</span>
                    </option>
                    <option v-for="(province, index) in provinces" :key="index" :value="province">{{ province }}</option>
                </select>
            </div>

            <div class="select">
                <label>片区：</label>
                <select v-model="selectedArea" @change="onAreaChange">
                    <option value="" disabled>
                        <span>请选择片区</span>
                    </option>
                    <option v-for="(area, index) in filteredAreas" :key="index" :value="area">{{ area }}</option>
                </select>
            </div>

            <div class="select">
                <label>日期：</label>
                <select v-model="selectedTime">
                    <option value="" disabled style="color: #fff;">
                        <span>请选择日期</span>
                    </option>
                    <option v-for="(time, index) in filteredTimes" :key="index" :value="time">{{ time }}</option>
                </select>
            </div>
        </div>

        <div class="button-container">
            <div @click="onSubmit" class="energy-button conventional">确定</div>
            <div @click="onCancel" class="energy-button new">重置</div>
        </div>
    </div>
</template>

<script>
export default {
    data() {
        return {
            provinces: ["河南省", "江西省", "湖北省"],
            times: ["2023/8/24",],
            areas: {
                湖北省: ["武汉市"],
                // 以省份为 key 的片区数据
                河南省: ["安鹤", "官渡南怀德", "惠济官渡北", '开商', '洛北济源', '洛阳南', '漯河', '南阳', '平顶山北区', '平顶山南区',
                    '濮阳', '三门峡新安', '新乡', '信阳', '许昌', '郑州西南', '周口', '驻马店',],
                江西省: ["北部", "东部", "抚州", "赣州", "南昌东", "西南部", "中部"],
            },
            left5Data: [
                {
                    name: '江西省',
                    cityName: '抚州',
                    areaName: '抚州',
                    value: [116.34, 28],
                    value1: [116.34, 28],
                    value2: [116.36, 28.2],
                    value3: [116.38, 28.5],
                    value4: [116.40, 28.7],
                },
                {
                    name: '江西省',
                    cityName: '赣州',
                    areaName: '赣州',
                    value: [114.92, 25.85],
                    value1: [114.92, 25.85],
                    value2: [114.94, 25.87],
                    value3: [114.96, 25.89],
                    value4: [114.98, 25.95],
                },
                {
                    name: '江西省',
                    cityName: '南昌',
                    areaName: '南昌东',
                    value: [115.89, 28.68],
                    value1: [115.89, 28.68],
                    value2: [115.91, 28.70],
                    value3: [115.93, 28.73],
                    value4: [115.95, 28.77],
                },
                {
                    name: '湖北省',
                    cityName: '武汉市',
                    areaName: '武汉市',
                    value: [114.34375, 30.49989],
                    value1: [114.34375, 30.50989],
                    value2: [114.36375, 30.51989],
                    value3: [114.38375, 30.52989],
                    value4: [114.40378, 30.53989],
                }
            ]
            ,
            selectedProvince: "",
            selectedArea: "",
            selectedTime: "",
            // 折线图数据
            allData: [
                // 最大供电能力
                [
                    // chart1
                    [
                        //常规电源
                        //火电总
                        [29001, 27347.75, 26765.57, 26628.42, 25694.39, 25755.97, 25595, 25467, 25527.42244, 25490.89365, 25125, 25052, 25056, 25040, 25148, 25243, 25272, 25081, 25045, 25018, 25098, 25522.17264, 25250, 25417, 26216.505, 27013.25, 26830.625, 27382.3226, 26270.13131, 26424.021, 26140, 26356.5, 25329, 25677.8829, 25061, 24691, 24137, 22520.7, 22207.2, 22111.25, 21993.45, 21787.3, 21676.15, 21535.55, 21560.25, 21880.4, 21860.45, 21475.7, 21395.9, 21356, 21339.85, 21336.05, 21299.95, 21299, 21368.35, 21344.6, 21284.75, 21295.2, 22562, 23210, 23834, 24102, 24256, 24647, 25102, 27012.07937, 27186.5, 29429.335, 31825.11, 30662.47, 31598.375, 32604.05, 33481.445, 33782.03, 33927.63, 35263.13266, 36218.76024, 34393.29, 35768.33, 35705.605, 36255.98, 35962.445, 35351.505, 35715.48, 36104.05, 36770.895, 34843.48, 34291.2, 34459.2, 34682.185, 33036.2],
                        //水电总
                        [739, 645.31, 578, 271, 1089, 1220, 594, 725, 605, 426, 272, 503, 727, 723, 929, 488, 437, 274, 273, 267, 574, 264, 717, 264, 1013, 940, 1010, 156, 771, 720, 260, 136, 483, 471, 123, 114, 106, 191, 188, 190, 191, 192, 195, 340, 687, 685, 242, 215, 219, 217, 216, 196, 198, 197, 198, 197, 197, 357, 1095, 698, 548, 698, 1067, 964, 1068, 1072, 958, 1410, 1166, 510, 1492.145, 1720.51, 2064, 2064, 2064, 2064, 1799.454759, 2064, 2064, 2065, 1950, 1930.025, 2065, 2066, 2005, 961, 2127, 2125, 2126, 1023.495, 2128]
                    ],
                    // chart2
                    [
                        2410.27, 3800, 3800, 3800, 3800, 3800, 3175.235, 2621.535, 2120.017557, 1824.496346, 1864.61, 1264.41, 958.15, 1265.31, 1534.9, 1938.86, 2035.8, 2015.72, 1714.98, 1858.54, 1437.81, 1576.877361, 1829.56, 2649.85, 3198.38, 3112.755, 3800, 3800, 3800, 3800, 3800, 3800, 3800, 3617.587105, 3548.414121, 2432.665066, 2221.536633, 2546.727124, 1730.239546, 875.5616174, 768.6928239, 446.3551938, 20.865, 154.0326695, 250.6634437, 518.4214486, 621.2954051, 930.96, 1211.77, 1106.12, 1159.42, 1312.2, 1751.77, 1722.67, 1861.86, 2047.29, 1965.1, 2048.87, 736.555, 1160.57, 984.93, 1191.94, 1197.19, 1841.41, 2827.83, 2295.810629, 3714.36, 2454.165, 1802.357343, 3800, 3800, 3800, 3800, 3800, 3800, 3800, 3800, 3800, 3800, 3800, 3800, 3800, 3800, 3800, 3800, 3800, 3800, 3800, 3800, 3800, 3800
                    ],
                    // chart3
                    [
                        // 总发电功率
                        [
                            0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, -455.37, -912.4126025, -1285.031311, -1801.360996, -1609.99, -2645.67, -1938.82, -2700, -2539.894121, -1868.055066, -1421.576633, -981.6071236, -586.0195458, -350.9116174, -630.3228239, -119.9551938, 0, -21.8226695, -216.2134437, -379.9914486, -34.97540507, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 70.73265678, 1500, 1417.71, 1500, 1500, 1500, 1500, 311.5573432, 300.325, 1500, 0, 489.175, 0, 0, 471.875, 457.25, 0, 0, 0, 0, 0, 0, 0
                        ],
                        // 总发电量
                        [
                            5625, 5625, 5625, 5625, 5625, 5625, 5625, 5625, 5625, 5625, 5625, 5625, 5625, 5625, 5625, 5625, 5625, 5625, 5625, 5625, 5625, 5625, 5625, 5625, 5625, 5625, 5602.2315, 5556.61087, 5492.359304, 5402.291255, 5321.791755, 5189.508255, 5092.567255, 4957.567255, 4830.572548, 4737.169795, 4666.090964, 4617.010607, 4587.70963, 4570.164049, 4538.647908, 4532.650148, 4532.650148, 4531.559015, 4520.748343, 4501.74877, 4500, 4500, 4500, 4500, 4500, 4500, 4500, 4500, 4500, 4500, 4500, 4500, 4500, 4500, 4500, 4500, 4500, 4500, 4500, 4500, 4500, 4500, 4500, 4500, 4500, 4500, 4500, 4500, 4500, 4500, 4500, 4500, 4500, 4500, 4500, 4500, 4500, 4500, 4500, 4500, 4500, 4500, 4500, 4500, 4500
                        ]
                    ],
                    // chart4
                    [
                        49100, 48783, 48019, 47363, 46921, 46673, 46086, 45767, 45142, 44714, 44316, 43945, 43648, 43461, 43276, 42982, 42955, 42579, 42421, 42393, 42525, 42620, 42884, 43396, 44765, 45257, 45341, 44744, 44278, 44605, 44688, 44964, 45485, 46680, 47094, 47751, 47996, 48853, 49814, 49761, 50204, 50600, 51115, 51734, 52318, 53114, 52935, 52617, 52793, 52837, 53178, 53150, 52763, 52391, 52425, 52615, 53302, 53494, 53589, 53436, 53169, 53306, 52659, 53000, 53373, 53770, 54305, 53979, 53852, 53813, 53904, 53667, 53601, 53233, 53004, 52954, 53614, 53733, 54005, 54268, 54117, 53854, 53922, 54294, 54660, 54482, 53886, 53294, 52944, 52000, 51311
                    ]
                ],
                //新能源消纳
                [
                    // chart1
                    [
                        //火电总
                        [
                            35152.86314, 34628.81928, 35565.57, 35428.42, 33314.26506, 34555.97, 32834.69277, 32156.58434, 31587.86747, 31424.73494, 31150.62651, 31316.41, 31014.15, 30747.57831, 29253.6747, 30043.81695, 30045.45855, 29865.70397, 29530.50193, 29790.37012, 29071.6988, 29913.76096, 29708.90324, 31243.41067, 32814.885, 35126.005, 35128.05422, 36769.91, 36172.07391, 33422.66, 34371.66889, 32510.83, 32790.18, 33568.14965, 31852.0185, 30855.61, 30536.96, 29685.82, 29211.35742, 29011.91, 29231.82, 29213.7, 28797.015, 28767.76, 28694.7, 28178.33, 28851.56117, 28006.66, 28207.67, 29262.12, 29217.64208, 29448.25, 28651.72, 28621.67, 29027.78839, 27791.89, 27649.85, 28118.445, 28898.555, 28770.57, 30418.93, 30893.94, 29853.19, 31608.41, 33023.81967, 34907.89, 36500.86, 37483.5, 37138.3487, 40062.47, 41753.23, 42181.80189, 43177.925, 42602.78629, 43576.83425, 43547.01646, 44219.80618, 45729.39816, 45526.96792, 46058.54134, 46081.52898, 43977.936, 44969.87203, 45597.49301, 46121.9958, 44144.69761, 44062.65, 43798.755, 44543.3256, 42425.05897, 41655.69531
                        ],
                        //水电总
                        [
                            739, 512, 578, 271, 1089, 1220, 594, 725, 605, 426, 272, 503, 727, 723, 929, 488, 437, 274, 273, 267, 574, 264, 717, 264, 1013, 940, 1010, 156, 771, 720, 260, 136, 483, 471, 123, 114, 106, 191, 188, 190, 191, 192, 195, 340, 687, 685, 242, 215, 219, 217, 216, 196, 198, 197, 198, 197, 197, 1182.625, 1095, 698, 548, 698, 1067, 964, 1068, 1072, 958, 1410, 1166, 510, 655, 199, 534, 726, 1445.029145, 208, 430, 365, 1313.918542, 1020.458412, 181.278685, 2064, 2065, 484, 196, 2094, 844, 732, 590, 688, 920
                        ]
                    ],
                    // chart2
                    [
                        -3741.59314, -3347.759277, -5000, -5000, -3819.87506, -5000, -4064.457771, -4068.049337, -3940.42747, -4109.34494, -4161.016506, -5000, -5000, -4442.268313, -2570.774699, -2861.956947, -2737.658554, -2768.983973, -2770.521928, -2913.83012, -2535.888795, -2814.710964, -2629.34324, -3176.560666, -3400, -5000, -4952.799217, -5000, -5000, -5000, -5000, -5000, -5600, -5600, -5600, -5600, -5600, -5600, -5600, -5600, -5600, -5600, -5600, -5600, -5600, -5600, -5600, -5600, -5600, -5600, -5600, -5600, -5600, -5600, -5600, -5600, -5600, -5600, -5600, -5600, -5600, -5600, -5600, -5600, -5600, -5600, -5600, -5600, -4564.223077, -5600, -5600, -3262.779176, -3638.414468, -3682.756289, -3730.233393, -3816.326459, -4031.266184, -4337.108164, -5600, -5019.219755, -4256.827665, -4349.465996, -5346.492032, -4042.763012, -4408.945805, -4706.802606, -4136.17, -4314.555, -4748.125603, -3607.378974, -3611.495313
                    ],
                    // chart3
                    [
                        //发电功率总
                        [
                            0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, -1500, -2386.973911, 0, -1041.658889, 0, 0, -1372.679646, -182.4985, 0, 0, 0, -259.9374167, -776.01, -1500, -1500, -1500, -1500, -1500, -559.5, -804.7911667, 0, 0, -1200, -1118.372081, -1200, 0, 0, -197.5783898, 1200, 1200, 0, 0, 1200, 0, 0, 1200, 480, 506.0103333, 0, 0, 0, 1124.07438, 1500, 1500, 506.5372849, 771.9344684, 1500, 0, 1500, 1500, 0, 391.4435337, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0
                        ],
                        // 发电量总
                        [
                            5625, 5625, 5625, 5625, 5625, 5625, 5625, 5625, 5625, 5625, 5625, 5625, 5625, 5625, 5625, 5625, 5625, 5625, 5625, 5625, 5625, 5625, 5625, 5625, 5625, 5625, 5625, 5550, 5430.651304, 5430.651304, 5378.56836, 5378.56836, 5378.56836, 5309.934378, 5300.809453, 5300.809453, 5300.809453, 5300.809453, 5287.812582, 5249.012082, 5174.012082, 5099.012082, 5024.012082, 4949.012082, 4874.012082, 4846.037082, 4805.797524, 4805.797524, 4805.797524, 4745.797524, 4689.878919, 4629.878919, 4629.878919, 4629.878919, 4620, 4620, 4620, 4620, 4620, 4620, 4620, 4620, 4620, 4620, 4620, 4620, 4620, 4620, 4620, 4620, 4620, 4620, 4620, 4620, 4620, 4620, 4620, 4620, 4620, 4620, 4620, 4620, 4620, 4620, 4620, 4620, 4620, 4620, 4620, 4620, 4620
                        ]
                    ],
                    // chart4
                    [
                        49100, 48783, 48019, 47363, 46921, 46673, 46086, 45767, 45142, 44714, 44316, 43945, 43648, 43461, 43276, 42982, 42955, 42579, 42421, 42393, 42525, 42620, 42884, 43396, 44765, 45257, 45341, 44744, 44278, 44605, 44688, 44964, 45485, 46680, 47094, 47751, 47996, 48853, 49814, 49761, 50204, 50600, 51115, 51734, 52318, 53114, 52935, 52617, 52793, 52837, 53178, 53150, 52763, 52391, 52425, 52615, 53302, 53494, 53589, 53436, 53169, 53306, 52659, 53000, 53373, 53770, 54305, 53979, 53852, 53813, 53904, 53667, 53601, 53233, 53004, 52954, 53614, 53733, 54005, 54268, 54117, 53854, 53922, 54294, 54660, 54482, 53886, 53294, 52944, 52000, 51311
                    ]
                ],
                //原始数据
                [
                    //left1
                    [
                        //常规电源
                        [
                            // 火电
                            [1980, 1977, 1971, 1969, 1968, 1969, 1961, 1772, 1660, 1663, 1656, 1650, 1646, 1647, 1643, 1647, 1665, 1661, 1660, 1659, 1662, 1659, 1667, 1662, 1682, 1675, 1717, 1739, 1812, 1699, 1669, 1674, 1669, 1670, 1667, 1610, 1527, 1384, 1353, 1344, 1346, 1342, 1350, 1346, 1344, 1346, 1339, 1344, 1342, 1349, 1348, 1345, 1345, 1346, 1343, 1354, 1346, 1350, 1347, 1354, 1368, 1367, 1374, 1460, 1478, 1569, 1633, 1667, 1760, 1923, 2160, 2402, 2647, 2694, 2726, 2766, 2761, 2721, 2776, 2770, 2775, 2769, 2710, 2702, 2701, 2699, 2699, 2700, 2703, 2694, 2600, 2619, 2663, 2599, 2588, 2594],
                            // 水电
                            [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]
                        ],
                        // 新能源
                        [
                            //风电
                            [238, 235, 233, 213, 233, 224, 234, 251, 269, 288, 288, 297, 277, 278, 278, 281, 300, 312, 313, 311, 326, 333, 312, 337, 347, 381, 399, 416, 443, 489, 497, 460, 452, 461, 467, 480, 521, 485, 501, 489, 442, 426, 380, 357, 353, 324, 316, 307, 297, 251, 238, 212, 202, 174, 152, 130, 113, 101, 95, 77, 70, 69, 63, 64, 64, 62, 53, 50, 46, 56, 64, 69, 78, 90, 100, 130, 155, 177, 205, 216, 218, 213, 191, 189, 200, 210, 225, 231, 246, 243, 260, 269, 263, 267, 285, 281],
                            //光伏
                            [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 2, 2, 2, 2, 12, 31, 73, 117, 144, 187, 218, 314, 408, 524, 655, 790, 719, 740, 1039, 1149, 1263, 1359, 1526, 1815, 1774, 1709, 1762, 1867, 1739, 1983, 1919, 1989, 1773, 1822, 1794, 1774, 1818, 1822, 1679, 1575, 1412, 1445, 1287, 1098, 1119, 933, 818, 685, 547, 436, 321, 220, 144, 84, 36, 9, 5, 5, 4, 3, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]
                        ]
                    ],
                    // left2
                    [
                        2678, 2677, 2657, 2679, 2500, 2269, 2271, 2385, 2298, 2221, 2221, 2152, 2112, 2113, 2124, 2169, 2211, 2149, 1947, 1938, 1893, 1951, 1975, 2023, 2117, 2189, 2192, 2211, 2247, 2080, 2106, 2132, 2084, 2017, 1960, 1927, 1843, 1722, 1672, 1627, 1627, 1623, 1622, 1621, 1614, 1625, 1613, 1621, 1605, 1606, 1621, 1603, 1624, 1608, 1622, 1631, 1630, 1615, 1627, 1624, 1627, 1684, 1719, 1721, 1808, 1880, 2016, 2242, 2418, 2600, 2811, 3000, 3258, 3420, 3574, 3606, 3528, 3379, 3473, 3512, 3538, 3542, 3501, 3631, 3730, 3790, 3720, 3677, 3646, 3595, 3472, 3509, 3393, 3394, 3412, 3162
                    ],
                    // left3
                    [
                        // 南阳 发电量
                        118, 118, 118, 118, 118, 118, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, -286, -569, -569, -567, -566, -566, -563, -565, -566, -563, -627, -968, -1246, -1243, -1240, -1237, -1231, -1233, -1228, -1230, -1220, -1224, -1220, -1213, -1215, -1212, -1205, -1200, -1199, -1195, -1195, -1197, -1188, -926, -655, -386, 0, 301, 633, 1023, 1023, 1023, 1023, 1023, 1023, 1023, 1024, 1023, 1022, 1009, 986, 985, 1024, 1022, 986, 1024, 1023, 1024, 1024, 905, 904, 906, 906, 904, 905, 905, 906, 905, 905
                    ],
                    // left4
                    [
                        723, 703, 749, 670, 684, 622, 828, 799, 859, 779, 725, 777, 712, 636, 716, 659, 637, 641, 555, 643, 546, 566, 685, 621, 680, 948, 909, 1093, 929, 888, 761, 781, 664, 647, 634, 709, 727, 1001, 1304, 1463, 1263, 1182, 1323, 1129, 1180, 1231, 1287, 1208, 1356, 1333, 1127, 1203, 1330, 1467, 1474, 1504, 1531, 1551, 1705, 1674, 1547, 1451, 1339, 1030, 839, 563, 231, 321, 262, 264, 134, -64, -197, -186, -204, -321, -267, -120, -228, -220, -216, -66, -101, 117, 126, 101, 180, 203, 57, 98, 71, -110, -152, 103, -140, -200
                    ],
                ]
            ]
        };
    },
    computed: {
        filteredAreas() {
            // 根据所选省份筛选片区
            return this.areas[this.selectedProvince] || [];
        },
        filteredTimes() {
            // 这里可以根据所选省份和片区筛选时间
            // 实现筛选逻辑
            return this.times;
        }
    },
    methods: {
        onProvinceChange() {
            // Reset片区 and时间选择
            this.selectedArea = "";
            this.selectedTime = "";
        },
        onAreaChange() {
            // Reset时间选择
            this.selectedTime = "";
        },
        onSubmit() {
            // 根据 selectedArea 进行筛选
            const filteredData = this.left5Data.filter(item => item.areaName === this.selectedArea);
            console.log(filteredData);
            // 触发事件，将筛选后的数据发送给全局事件总线

           if(this.selectedProvince){
            if (this.selectedArea) {
                this.$bus.$emit('left5Data', filteredData);
                console.log('leftData');
            } else {
                this.$bus.$emit('allData', this.allData)
            }
           }
            // 重置选择
            this.selectedProvince = "";
            this.selectedArea = "";
            this.selectedTime = "";
        },
        onCancel() {
            // 在取消时重置选择
            this.selectedProvince = "";
            this.selectedArea = "";
            this.selectedTime = "";
        }
    }
};
</script>


<style lang="scss" scoped>
.gis-selection {
    display: flex;
    flex-direction: column;
    font-size: 20px;

    .date-selection {
        display: flex;
        flex-direction: column;
    }

    .button-container {
        display: flex;
        flex-direction: row;

        .energy-button {
            padding: 1px 2px;
            margin-top: 3px;
            margin-left: 2px;
            border-radius: 3px;
            font-size: 18px;
            cursor: pointer;
            text-align: center;
            font-weight: bold;
            width: 40.5%;
            color: rgb(55, 209, 259);
            transition: background-color 0.3s;

            &.conventional {
                margin-left: 4.3rem;
                background-color: rgba(84, 122, 194, .5);
            }

            &.new {
                background-color: rgba(84, 122, 194, .5);
            }

            &:hover {
                color: rgb(2, 188, 233);
                background-color: rgb(14, 33, 72);
            }
        }
    }
}

.select {
    margin: 10px;

    label {
        font-weight: bold;
        color: rgb(55, 209, 259);
        // margin-right: 10px;
    }

    select {
        background-color: rgb(7, 39, 87);
        width: 86%;
        height: 34px;
        font-weight: bold;
        color: #fff;
    }

}
</style>